<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador de Sal√°rios Brasil 2025</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f8f9fa; }
        .card { box-shadow: 0 4px 12px rgba(0,0,0,0.1); border: none; border-radius: 12px; }
        .header-bg { background: linear-gradient(135deg, #0d6efd, #0043a8); color: white; padding: 2.5rem 0; margin-bottom: 2rem; }
        
        .result-box { 
            background-color: #ffffff; 
            border: 2px solid #e9ecef;
            border-radius: 12px; 
            padding: 25px; 
            text-align: center; 
            display: none; 
            margin-top: 25px;
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .result-value { font-size: 2.8rem; font-weight: 800; color: #198754; line-height: 1.2; }
        .result-range { font-size: 1.1rem; color: #6c757d; margin-top: 5px; font-weight: 500; }
        .badge-uf { background-color: #e3f2fd; color: #0d6efd; padding: 5px 10px; border-radius: 20px; font-size: 0.85rem; font-weight: 600; margin-bottom: 10px; display: inline-block; }
        
        /* Ajuste do bot√£o */
        .btn-calc { padding: 12px; font-size: 1.1rem; font-weight: 600; }
    </style>
</head>
<body class="d-flex flex-column min-vh-100">

    <div class="header-bg text-center">
        <h1 class="fw-bold">üí∞ Simulador de Sal√°rios Brasil</h1>
        <p class="lead opacity-75">Baseado em dados da PNADc 2025 (IBGE) e Microeconometria</p>
    </div>

    <div class="container pb-5 flex-grow-1">
        <div class="row justify-content-center">
            <div class="col-md-8 col-lg-6">
                <div class="card p-4">
                    <form id="salaryForm">
                        <h5 class="mb-3 text-primary fw-bold">1. Seu Perfil</h5>
                        
                        <div class="row">
                            <div class="col-6 mb-3">
                                <label class="form-label small fw-bold">Idade</label>
                                <input type="number" class="form-control" id="idade" value="30" min="14" max="80" required>
                            </div>
                            <div class="col-6 mb-3">
                                <label class="form-label small fw-bold">Anos de Estudo</label>
                                <select class="form-select" id="estudo">
                                    <option value="0">Sem instru√ß√£o</option>
                                    <option value="4">Fundamental Inc.</option>
                                    <option value="9">Fundamental Comp.</option>
                                    <option value="12" selected>M√©dio Completo</option>
                                    <option value="16">Superior Completo</option>
                                    <option value="18">P√≥s-Gradua√ß√£o</option>
                                </select>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-6 mb-3">
                                <label class="form-label small fw-bold">G√™nero</label>
                                <select class="form-select" id="sexo">
                                    <option value="homem">Homem</option>
                                    <option value="mulher">Mulher</option>
                                </select>
                            </div>
                            <div class="col-6 mb-3">
                                <label class="form-label small fw-bold">Cor / Ra√ßa</label>
                                <select class="form-select" id="cor">
                                    <option value="branca">Branca / Amarela</option>
                                    <option value="preta">Preta / Parda</option>
                                </select>
                            </div>
                        </div>

                        <hr class="my-4">
                        <h5 class="mb-3 text-primary fw-bold">2. Mercado de Trabalho</h5>

                        <div class="mb-3">
                            <label class="form-label small fw-bold">Setor de Atividade</label>
                            <select class="form-select" id="setor">
                                <option value="1">Agricultura e Pecu√°ria</option>
                                <option value="2">Ind√∫stria Geral</option>
                                <option value="3">Ind√∫stria de Transforma√ß√£o</option>
                                <option value="4">Eletricidade e G√°s</option>
                                <option value="5">Saneamento e Res√≠duos</option>
                                <option value="6">Constru√ß√£o Civil</option>
                                <option value="7">Com√©rcio e Repara√ß√£o</option>
                                <option value="8">Transporte e Correio</option>
                                <option value="9">Alojamento e Alimenta√ß√£o</option>
                                <option value="10">Tecnologia e Informa√ß√£o</option>
                                <option value="11">Administra√ß√£o P√∫blica</option>
                                <option value="12">Educa√ß√£o, Sa√∫de e Servi√ßos</option>
                            </select>
                        </div>

                        <div class="mb-4">
                            <label class="form-label small fw-bold">Estado (UF) para Simula√ß√£o</label>
                            <select class="form-select" id="uf">
                                <option value="11">Rond√¥nia (RO)</option>
                                <option value="12">Acre (AC)</option>
                                <option value="13">Amazonas (AM)</option>
                                <option value="14">Roraima (RR)</option>
                                <option value="15">Par√° (PA)</option>
                                <option value="16">Amap√° (AP)</option>
                                <option value="17">Tocantins (TO)</option>
                                <option value="21">Maranh√£o (MA)</option>
                                <option value="22">Piau√≠ (PI)</option>
                                <option value="23">Cear√° (CE)</option>
                                <option value="24">Rio G. do Norte (RN)</option>
                                <option value="25">Para√≠ba (PB)</option>
                                <option value="26">Pernambuco (PE)</option>
                                <option value="27">Alagoas (AL)</option>
                                <option value="28">Sergipe (SE)</option>
                                <option value="29">Bahia (BA)</option>
                                <option value="31">Minas Gerais (MG)</option>
                                <option value="32">Esp√≠rito Santo (ES)</option>
                                <option value="33">Rio de Janeiro (RJ)</option>
                                <option value="35" selected>S√£o Paulo (SP)</option>
                                <option value="41">Paran√° (PR)</option>
                                <option value="42">Santa Catarina (SC)</option>
                                <option value="43">Rio G. do Sul (RS)</option>
                                <option value="50">Mato G. do Sul (MS)</option>
                                <option value="51">Mato Grosso (MT)</option>
                                <option value="52">Goi√°s (GO)</option>
                                <option value="53">Distrito Federal (DF)</option>
                            </select>
                        </div>

                        <div class="d-grid">
                            <button type="button" class="btn btn-primary btn-calc shadow-sm" onclick="calcularSalario()">
                                Calcular Estimativa
                            </button>
                        </div>
                    </form>

                    <div id="resultado" class="result-box">
                        <span class="badge-uf" id="badgeUF">M√©dia Estimada</span>
                        <div class="result-value" id="valorEstimado">R$ 0,00</div>
                        
                        <div class="result-range">
                            Faixa prov√°vel: <br>
                            <strong id="faixaMin">R$ 0,00</strong> at√© <strong id="faixaMax">R$ 0,00</strong>
                        </div>
                        
                        <p class="mt-3 text-muted" style="font-size: 0.8rem;">
                            *Valores brutos mensais (40h). A faixa representa a varia√ß√£o estat√≠stica de 95% para este perfil.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="mt-auto py-4 bg-white border-top text-center text-muted">
        <div class="container">
            <p class="mb-1 fw-bold text-dark">Jo√£o Vitor dos Santos Sobrinho <span class="fw-normal text-secondary">(Economia/UEFS)</span></p>
            <p class="mb-0 small">Projeto acad√™mico sem fins lucrativos.</p>
        </div>
    </footer>

    <script>
        let modelo = null;

        // Carrega o JSON
        fetch('modelo_salario_coeficientes_2025_geral.json') // <--- ATEN√á√ÉO AO NOME DO ARQUIVO
            .then(response => response.json())
            .then(data => {
                modelo = data; // Guarda o objeto inteiro para acessar meta_info
                console.log("Modelo carregado!", modelo.meta_info);
            })
            .catch(error => {
                console.error('Erro:', error);
                alert('Erro ao carregar os dados do modelo.');
            });

        function calcularSalario() {
            if (!modelo) {
                alert("O modelo ainda est√° carregando...");
                return;
            }

            const coef = modelo.coeficientes;
            const sigma = modelo.meta_info.sigma_resid || 0.65; // Fallback se n√£o tiver sigma

            // Inputs
            const idade = parseFloat(document.getElementById('idade').value);
            const anosEstudo = parseFloat(document.getElementById('estudo').value);
            const sexo = document.getElementById('sexo').value;
            const cor = document.getElementById('cor').value;
            const setor = document.getElementById('setor').value;
            const uf = document.getElementById('uf').value;

            // Experi√™ncia Minceriana
            let experiencia = idade - anosEstudo - 6;
            if (experiencia < 0) experiencia = 0;
            let experiencia2 = experiencia * experiencia;

            // Score Linear (Log do Sal√°rio)
            let score = coef['const'] || coef['Intercepto'] || 1.2;

            score += (coef['Anos_Estudo'] || 0) * anosEstudo;
            score += (coef['Experiencia'] || 0) * experiencia;
            score += (coef['Experiencia_2'] || 0) * experiencia2;

            if (sexo === 'mulher') score += (coef['d_mulher'] || 0);
            if (cor === 'preta') score += (coef['d_preto_pardo'] || 0);

            // UF
            let chaveUF = `UF_${uf}`;
            if (coef[chaveUF]) score += coef[chaveUF];

            // Setor
            let chaveSetor = `setor_${setor}`;
            if (coef[chaveSetor]) score += coef[chaveSetor];

            // IMR (Corre√ß√£o Vi√©s) - Assume m√©dia 0.6 para predi√ß√£o geral se n√£o calcular individualmente
            if (coef['IMR']) score += coef['IMR'] * 0.6; 

            // --- C√ÅLCULO DOS INTERVALOS ---
            // Intervalo de Confian√ßa de 95% (z = 1.96)
            // No logaritmo:
            let log_medio = score;
            let log_min = score - (1.96 * sigma);
            let log_max = score + (1.96 * sigma);

            // Reverte Log para Reais (Exponencial)
            // Multiplica por 4.5 semanas * 40 horas = 180 horas mensais
            const horasMensais = 4.5 * 40; 
            
            let salarioMedio = Math.exp(log_medio) * horasMensais;
            let salarioMin = Math.exp(log_min) * horasMensais;
            let salarioMax = Math.exp(log_max) * horasMensais;

            // Atualiza UI
            const fmt = new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' });

            document.getElementById('valorEstimado').innerText = fmt.format(salarioMedio);
            document.getElementById('faixaMin').innerText = fmt.format(salarioMin);
            document.getElementById('faixaMax').innerText = fmt.format(salarioMax);
            
            // Texto da Badge
            const nomeUF = document.getElementById('uf').options[document.getElementById('uf').selectedIndex].text;
            document.getElementById('badgeUF').innerText = `Estimativa para: ${nomeUF}`;

            // Exibir
            const resultBox = document.getElementById('resultado');
            resultBox.style.display = 'block';
            resultBox.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
    </script>

</body>
</html>
